services:

  php_layout.type_registry:
    public: false
    class: MakinaCorpus\Layout\Type\ItemTypeRegistry

  php_layout.identifier_strategy:
    public: false
    class: MakinaCorpus\Layout\Render\StorageIdentifierStrategy

  php_layout.grid_renderer:
    public: false
    class: MakinaCorpus\Drupal\Layout\Render\EditLinksRendererDecorator
    arguments: ['@php_layout.context']

  php_layout.renderer:
    class: MakinaCorpus\Layout\Render\Renderer
    arguments: ['@php_layout.type_registry', '@php_layout.grid_renderer', '@php_layout.identifier_strategy']

  php_layout.type.drupal_node:
    public: false
    class: MakinaCorpus\Drupal\Layout\Type\NodeType
    arguments: ['@entity.manager']
    tags: [{name: php_layout.type}]

  php_layout.storage:
    class: MakinaCorpus\Drupal\Layout\Storage\LayoutStorage
    arguments: ['@database', '@php_layout.type_registry']

  php_layout.token_storage:
    class: MakinaCorpus\Drupal\Layout\Storage\TokenLayoutStorage
    arguments: ['@database']

  php_layout.token_generator:
    public: false
    class: MakinaCorpus\Layout\Controller\DefaultTokenGenerator

  php_layout.context:
    class: MakinaCorpus\Layout\Controller\Context
    arguments: ['@php_layout.storage', '@php_layout.token_storage', '@php_layout.token_generator']
